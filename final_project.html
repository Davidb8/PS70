<!DOCTYPE html>
<html>

<head>
  <title>PS70: Final Project</title>
  <link rel="stylesheet" type="text/css" href="style.css">

  <style>
    h2 {
      display: block;
      margin-left: auto;
      margin-right: auto;
      background-color: #dddddd;
      padding: 10px;
      width: max-content;
      text-align: center;
    }

    p {
      padding-left: 15rem;
      padding-right: 15rem;
      font-size: 1.3rem;
    }

    .video-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 50vh;
    }
  </style>

</head>

<body>
  <header>
    <nav>
      <ul>
        <li><a href="./index.html">Home</a></li>
        <li><a href="./about.html">David Brown?</a></li>
        <li><a href="./final_project.html">Final Project</a></li>
      </ul>
    </nav>
    <h1>Final Project</h1>
  </header>

  <main>
    <div>
      <h2>Version 1</h2>
      <div class="video-container">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/LhoHu-jz-vw?mute=1"
          title="YouTube video player" frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen></iframe>
      </div>
      <br><br>
      <p>
        After many hours slaved away in the lab, I have arrive at the revision one BarBot. The system
        allows for 6 different drink inputs transported via peristaltic motor pumps for maintaining sanitary conditions.
        BarBot uses hijacked button
        inputs from a Keurig, allowing the user to scroll through the menu on the TFT display, using buttons for Up,
        Down, and OK. It can pour 1 shot
        worth of liquid in about 10 seconds currently. The entire system is powered using 1 9V DC plug.
      </p>
    </div>

    <div>
      <h2>The Vision</h2>
      <p>
        My Final Project is BarBot, everyone's favorite bartending assistant.
        <br><br>
        Gone are the days of trying and failing to craft cocktails and not knowing what to do. And gone are the days of
        being bogged down by countless
        repetitive motions of measuring out shots. Bar bot will be similar to the now growing craze of the "Bartesian",
        which works like a Keurig that
        takes in a pod of cocktail mixture as well as your preferred liquors, and crafts the perfect ratio. I envision
        something with a little more flexability,
        variety, and user involvement.
        <br><br>
        <img src="bartesian.jpg" alt="Bartesian Example" width="35%">
        <br><br>
        The vision is that you can either manually select what you need from the BarBot to be dispensed (1.5 oz of some
        liquor), and it will be
        hooked up to all of the necessary bottles located in a discrete lower location. Then it is just a matter of
        inserting the shaker or whatever
        container you are using and pressing a button and it will dispense what you need. The second mode is the cool
        part. There will be several NFC
        cards each labeled with a different drink, you can tap the card, and the display with give you instructions on
        how to craft the cocktail.
        It will tell you what you need to do step by step, where you put in the non liquid ingredients, and the BarBot
        will pour in everything else.
        Now, anyone and everyone can be a professional bartender!
        <br><br>
      </p>
    </div>

    <div>
      <h2>The (original) Plan</h2>
      <p>
        All good plans start with knowing what I will need. For the body of the BarBot, I will use extruded aluminum to
        build a cage, that is
        filled in with either a nice finished wood, or acrylic. Those will be the main two materials for my structure.
        For the mechanical parts,
        I will need a lot of tubing, stepper motors, bottle fittings, and o ring type seals to keep everything clean and
        airtight. Finally for
        electronics I will need to have an Arduino (Uno or eps32), NFC reader and cards, digital output display, and
        assorted wires.
        <br><br>
        I hope to develop all of the electronics and mechanics through the next weeks. I want to be able to generate a
        digital output based on a
        NFC card being read, as well as design an efficient system for pumping up liquid approximately 3 feet without
        requiring a ton of different
        motors or moving parts. In terms of developing parts, I currently don't see a need for 3D printed parts, as most
        everything can be fabricated
        with alternative methods, but there will likely be some fittings for connecting different pieces together where
        I may use 3D printing to
        save some labor. If I can achieve both of those technical feats in later the weeks of the class, then I am going
        to be in a really good spot.
        I'll then be able to focus on putting pieces together and creating an external shell in the final weeks of the
        semester, and end up with
        the worlds first BarBot!
        <br><br>
        These are some sketches regarding the final project ideas
        <br><br>
        <img src="Final Project Photos/initial sketch 1.png" alt="OG Design sketch 1" width="25%">
        <img src="Final Project Photos/initial sketch 2.png" alt="OG Design sketch 2" width="25%">
        <img src="Final Project Photos/initial sketch 3.png" alt="OG Design sketch 3" width="25%">
        <br><br>
      </p>
    </div>

    <div>
      <h2>Development</h2>
      <p>
        The first stage of development was centered around the Minimum Viable Product (MVP). For me, this was the
        pumping mechanism, specifically making a peristaltic stepper motor pump.
        The development for this is linked <a href="./Week10/Week10_index.html">here</a>. At the end, I found that
        the flowrate was way too low to be ~viable~ for my ~product~ at about 50ml/minute. This was due to the low
        operating speed of the stepper motors.
        <br><br>
        So I eventually decided to do a a design with submergible pumps as they flow significantly faster and are very
        smooth.
        The main drawback to this approach was that the pumps need to be ... well submerged, which goes against the
        original design with tubing that feeds out the back of the system. They also dont have any sort of pressure
        regulation meaning that they cant resist the flow of gravity, so some sort of anticipation is needed to be done
        regarding that. This is a preliminary sketch I made with this model.

        <br><br>
        <img src="Final Project Photos/revised sketch.png" alt="submergible pump sketch" width="25%">
        <br><br>

        I then began testing with this system design, as well as shifting over my parts to EPS32 based code. The Arduino
        is just not powerful enough to allow the TFT to update the display in a fast enough manor, so it would be a bit
        clunky (see the gif from a previous week of testing). The eps32s2 dev boards dont have all the VSPI pin outs
        necessary to have an SPI communication protocol, so I had to order a different board on amazon using the esp32
        WROOM chip that had all the needed pins.

        <br><br>

        The board I got was... challenging to use, it had issues with serial interference with the TFT display when
        uploading code, and required pulling down GPIO0 to force a dev mode (but its what you expect when you buy an $8
        board from some random shop). After a good bit of testing, I was able to get a system working where when a NFC
        card is present, a pouring animation occurs while the submergible pump runs. It was a bit of a pain in the ass
        to get code to work for getting the timings on the animation and pump powering, and have it look satisfying. I
        decided to use a relay to control the motor, basically sending power to a input pin will close a connection,
        that way it can use the 9V power supply, and not drain the esp32.

        <br><br>
        <video width="480" height="360" controls>
          <source src="Final Project Photos/eps32_Initial_Demo.mp4" type="video/mp4" width="40%">
        </video>
        <br><br>

        So this all seemed to work out great. So its about time to start putting everything together to create a cool
        system. Then boom. We get a set of new peristaltic pumps that just used regular DC Motors, and thus operate WAY
        faster than the previous model I made. They were fast enough to warrant using, so back to the drawing board I
        guess. Not really, but I then decided to go back to my original design.

        <br><br>

        I had a Keurig laying around (Not much of a coffee drinker), so I decided it would be cool to try and put my
        system inside of coffee maker since I was going back to non submerged pumps. So I began the journey of taking
        apart the monster of a machine. I could have done it pretty quickly, but there were a lot of cool parts, like a
        transformer box, a water heater, and a ton of pumps that I figured the Fabrication Lab could put to use, so I
        took my time to salvage as much as possible.

        <br><br>
        <img src="Final Project Photos/Disassembly 1.jpg" alt="Disassembly 1" width="22%">
        <img src="Final Project Photos/Disassembly 2.jpg" alt="Disassembly 2" width="22%">
        <img src="Final Project Photos/Disassembly 3.jpg" alt="Disassembly 3" width="22%">
        <img src="Final Project Photos/Disassembly 4.jpg" alt="Disassembly 4" width="22%">
        <br><br>
        <img src="Final Project Photos/Disassembly 5.jpg" alt="Disassembly 5" width="40%">
        <br><br>

        Then I found this circuit board that was being used for the button control. I decided that I wanted to hijack
        the board that way I could use their button system, which would give me a pretty cool effect.

        <br><br>
        <img src="Final Project Photos/Keurig Board.jpg" alt="Keurig Board" width="40%">
        <br><br>

        I used a ultrasonic cutter to cut out a piece of the top of the keurig so I could install my tft display. After
        doing some initial wiring I ended up with this.

        <br><br>
        <img src="Final Project Photos/Screen Install.jpg" alt="Screen Install" width="40%">
        <br><br>

        I made a quick code test, and this is the buttons and the screen working together in action. There is even a Red
        LED indicator light.

        <br><br>
        <img src="Final Project Photos/Initial_Screen_Test.gif" alt="Screen Test" width="40%">
        <br><br>

        Then it was on to the pump install. I basically attempted to shove all the pumps into where the water heater
        system was, as that had the most open space. It was a small nightmare trying to navigate both ends of the
        tubing, as well as keeping track of all the wiring connections. But I eventually got them all installed. Hooking
        everything up just meant getting a few more relays and making some shared wires - nothing too bad.

        <br><br>
        <img src="Final Project Photos/Final Guts.jpg" alt="Final Guts" width="32%">
        <img src="Final Project Photos/Initial_Pour_Test.gif" alt="Pour Test" width="32%">
        <img src="Final Project Photos/Final Front.jpg" alt="Final Front" width="32%">
        <br><br>
        <img src="Final Project Photos/Final Side.jpg" alt="Final Side" width="32%">
        <img src="Final Project Photos/Final Front.jpg" alt="Final Front" width="32%">
        <img src="Final Project Photos/Final Top.jpg" alt="Final Top" width="32%">
        <br><br>

        The pouring seems to work, and everything is maybe a bit clunky still, but not bad. So now its time to finish of
        building the code. I needed to create a menu system, and determine the timings for the pouring. The code I am
        using is linked <a download href='Week12/BarBot v3/BarBot v3.ino'>here.</a>. After a tremendous amount of
        testing, here are some action videos.

        <br><br>
        <video width="480" height="360" controls>
          <source src="Final Project Photos/Exterior.mp4" type="video/mp4" width="40%">
        </video>
        <br><br>
        <video width="480" height="360" controls>
          <source src="Final Project Photos/Screen_Finished.mp4" type="video/mp4" width="40%">
        </video>
        <br><br>
        <video width="480" height="360" controls>
          <source src="Final Project Photos/Rough_Full_Test.mp4" type="video/mp4" width="40%">
        </video>
        <br><br>

        After all of this I decided I was ready to try and box it up and make it look pretty. This was a mistake. I
        squished all of the wiring together, and ended up causing 9V line to touch one of the connectors for my eps32,
        which caused the board to fry and consequently not work. This all happened in a brief 5 minutes at 12:30 AM..
        Which was maybe not a high of a time. So I came back in the next morning and hooked up a slightly different
        eps32 that I bought on amazon just in case, and thankfully I was able to get it to work (and this one was a lot
        easier to use than the other version which was a nice thing to find out).

        <br><br>

        After verifying everything still works, I am ready to box it up. This time just for some storage, so I
        disconnected some of the wiring, and installed everything into its box.

        <br><br>
        <img src="Final Project Photos/Final Closed Front.jpg" alt="Final Closed Front" width="22%">
        <img src="Final Project Photos/Final Closed Side.jpg" alt="Final Closed Side" width="22%">
        <img src="Final Project Photos/Final Closed Top.jpg" alt="Final Closed Top" width="32%">
        <br><br>

        I do have a few more things left that I want to do for the version 2. First I obviously want to have all of the
        wiring fit and go inside of the Keurig case. I also want to secure all of the motors that way the tubing doesn't
        pinch itself, restricting flow. I want to clean up the top TFT display carriage, and I want to attempt using 12V
        input to see if that increases my flow speed. Finally, I may end up implementing the RFID scanner, or I may just
        use it for another project... Like an ordering system.




      </p>
    </div>


  </main>

</body>

</html>